<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="style.css" />
    <link rel="icon" type="image/x-icon" href="/photos/sun.png">
    <title>Weather</title>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7PKSHH8HZN"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-7PKSHH8HZN');
</script>


<body class="bodyBackground">
    <div class="container my-4">
        <div class="centerTitle">

            <title class="headerTitle">IoT Weather Dashboard</title>
            <hr class="hr">

            <form>
                <div class="buttonRow">

                    <label class="radio">
                        <input name="units" type="radio" id="fahrenheitRadio" checked
                            onclick="updateAllLabels(false)">
                        <span>Fahrenheit</span>
                    </label>
                    <label class="radio">
                        <input name="units" onclick="updateAllLabels(true)" type="radio"
                            id="celsiusRadio">
                        <span>Celsius</span>
                    </label>
                </div>
            </form>
        </div>



        <div class="TempRow">
            <div class="TombTemp">

                <div class="circleTemp colorRed">

                    <h2><span id="indoor">Loading...</span></h2>
                </div>
                <h3>
                    Indoor
                </h3>
            </div>
            <div class="TombTemp">
                <div class="circleTemp colorGreen">
                    <h2><span id="outdoor">Loading...</span> </h2>
                </div>
                <h3>
                    Outdoor
                </h3>
            </div>
            <div class="TombTemp">
                <div class="circleTemp colorBlue">
                    <h2> <span id="attic">Loading...</span></h2>
                </div>
                <h3>
                    Attic
                </h3>

            </div>
        </div>


        <div class="quoteRow">

            <blockquote class="quoteTemp">“It is hot outside! Grab a cold drink.”</blockquote>
            <div class="ImgCircleSmall"></div>
            <div class="circleTemp ImgCircle">
                <img class="Img" src="./photos/pot.png">
            </div>


        </div>
        <h2 class="gitHubLink">Check out this project on&nbsp;<a
                href="https://github.com/swharden/iot-weather-station">GitHub</a>!
        </h2>
        <h5 class="attributionLink">Created by &nbsp;<a href="https://leahxinli.com/">Leah Xinli
                Harden</a>!
        </h5>
        <script>
            fetch("https://swharden.com/weather/v1/current/", { cache: "no-store" })
                .then(response => response.json())
                .then(data => {
                    document.getElementById("indoor").innerText = data.indoor.temperature;
                    document.getElementById("outdoor").innerText = data.outdoor.temperature;
                    document.getElementById("attic").innerText = data.attic.temperature;
                });


            // This is changed the F and C

            function updateAllLabels(celsius) {
                updateLabel("indoor", celsius);
                updateLabel("outdoor", celsius);
                updateLabel("attic", celsius);
            }

            function updateLabel(id, celsius) {
                const el = document.getElementById(id);
                const roundedTemperatureF = parseFloat(el.dataset.temperatureF);
                const exactTemperatureC = (roundedTemperatureF - 32) / 9 * 5;
                const roundedTemperatureC = Math.round(exactTemperatureC * 100) / 100;

                // Add a CSS class to trigger the fade-in effect
                el.classList.add("fade-in");


                // Update the temperature label after a short delay
                setTimeout(() => {
                    el.innerHTML = celsius ? `${roundedTemperatureC} ºC` : `${roundedTemperatureF} ºF`;

                    // Remove the fade-in class after the animation is complete
                    setTimeout(() => {
                        el.classList.remove("fade-in");
                        // Add a fade-out class to trigger the fade-out effect
                        el.classList.add("fade-out");

                        // Remove the fade-out class after the animation is complete
                        setTimeout(() => {
                            el.classList.remove("fade-out");
                        }, 200);
                    }, 200);
                }, 200); // Adjust the delay as needed
            }

            function setValue(id, temperatureF) {
                document.getElementById(id).dataset.temperatureF = temperatureF;
                updateLabel(id);
            }

            fetch("https://swharden.com/weather/v1/current/", { cache: "no-store" })
                .then(response => response.json())
                .then(data => {
                    setValue("indoor", data.indoor.temperature);
                    setValue("outdoor", data.outdoor.temperature);
                    setValue("attic", data.attic.temperature);
                });


        </script>
</body>

</html>